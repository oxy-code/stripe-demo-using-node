"use strict";angular.module("stripePaymentsApp",["ngCookies","ngResource","ngSanitize","ui.router","ui.bootstrap","auth0","angular-storage","angular-jwt"]).config(["$stateProvider","$urlRouterProvider","$locationProvider","$httpProvider","authProvider","jwtInterceptorProvider",function(a,b,c,d,e,f){e.init({domain:"oxycode.auth0.com",clientID:"nZ75IlzdsYsp1lvbyiFC0PQIf6MPXpun",loginState:"login"}),b.otherwise("/"),c.html5Mode(!0),f.tokenGetter=["store",function(a){return a.get("token")}],d.interceptors.push("jwtInterceptor")}]).run(["$rootScope","auth","store","jwtHelper","$state",function(a,b,c,d,e){a.$on("$stateChangeStart",function(a,b,d,f,g){var h=c.get("token");h&&("logout"!=b.name&&"main"==b.name||"login"==b.name)&&(a.preventDefault(),e.go("dashboard"))}),b.hookEvents()}]),angular.module("stripePaymentsApp").service("userService",["$http",function(a){this.signup=function(b){return a.post("/api/users/",b)},this.signin=function(b){return a.post("/api/users/login",b)},this.getAll=function(){return a.get("/api/users/")},this.getStripeAll=function(){return a.get("/api/users/stripe")}}]),angular.module("stripePaymentsApp").controller("DashboardCtrl",["$scope","userService","store","$state","$http","$window",function(a,b,c,d,e,f){a.users=[],a.transactions=[],b.getAll().then(function(b){a.users=b.data}),b.getStripeAll().then(function(b){a.transactions=b.data}),a.logout=function(){e.get("/api/users/logout").then(function(a){c.remove("token"),c.remove("profile"),d.go("main"),f.location.reload()})},"logout"==d.current.name&&a.logout()}]),angular.module("stripePaymentsApp").config(["$stateProvider",function(a){a.state("dashboard",{url:"/dashboard",templateUrl:"app/dashboard/dashboard.html",controller:"DashboardCtrl"}).state("logout",{url:"/logout",template:'<p align="center">Please wait...</p>',controller:"DashboardCtrl"})}]),angular.module("stripePaymentsApp").controller("MainCtrl",["$scope","userService","Modal","ajaxLoaderService","store","$state",function(a,b,c,d,e,f){a.years=function(){for(var a=2015,b=2025,c=[],d=a;b>=d;d++)c.push(d);return c},a.accountSetup=function(e){if(angular.isUndefined(e))return c.info("Please fill all the details"),!1;var g=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i;return g.test(e.email)?isNaN(e.no)?(c.info("Enter the valid card number"),a.card.no="",!1):isNaN(e.cvc)?(c.info("Enter the valid CVC number"),a.card.cvc="",!1):(d.show(),void b.signup(e).then(function(a){d.hide(),c.info(a.data.message,function(){f.go("login")})},function(a){d.hide(),c.info(a.data.message)})):(c.info("Enter the valid email address"),!1)},a.login=function(a){if(angular.isUndefined(a))return c.info("Please fill all the details"),!1;var g=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i;return g.test(a.email)?(d.show(),void b.signin(a).then(function(a){d.hide(),e.set("token",a.data.token),e.set("profile",a.data.profile),f.go("dashboard")},function(a){d.hide(),c.info(a.data.message)})):(c.info("Enter the valid email address"),!1)}}]),angular.module("stripePaymentsApp").config(["$stateProvider",function(a){a.state("main",{url:"/",templateUrl:"app/main/main.html",controller:"MainCtrl"}).state("login",{url:"/login",templateUrl:"app/main/login.html",controller:"MainCtrl"})}]),angular.module("stripePaymentsApp").service("ajaxLoaderService",["$templateRequest","$templateCache",function(a,b){this.show=function(){if(angular.isUndefined(b.get("loader.html"))){var c=a("components/ajaxLoader/loader.html",!1);c.then(function(a){b.put("loader.html",a),angular.element("div.container").after(b.get("loader.html"))})}else angular.element("div.container").after(b.get("loader.html"))},this.hide=function(){var a=angular.element(".loader-overlay");a.length>0&&a.remove()}}]),angular.module("stripePaymentsApp").factory("Modal",["$rootScope","$modal",function(a,b){function c(c,d){var e=a.$new();return c=c||{},d=d||"modal-default",angular.extend(e,c),b.open({templateUrl:"components/modal/modal.html",windowClass:d,scope:e})}return{confirm:{"delete":function(a){return a=a||angular.noop,function(){var b,d=Array.prototype.slice.call(arguments),e=d.shift();b=c({modal:{dismissable:!0,title:"Confirm Delete",html:"<p>Are you sure you want to delete <strong>"+e+"</strong> ?</p>",buttons:[{classes:"btn-danger",text:"Delete",click:function(a){b.close(a)}},{classes:"btn-default",text:"Cancel",click:function(a){b.dismiss(a)}}]}},"modal-danger"),b.result.then(function(b){a.apply(b,d)})}}},info:function(a,b){var d;b=b||angular.noop,d=c({modal:{dismissable:!0,title:"Message",html:a||"<p>Sample Message</p>",buttons:[{classes:"btn-info",text:"OK",click:function(a){d.close(a)}}]}},"modal-info"),d.result.then(b)}}}]),angular.module("stripePaymentsApp").controller("NavbarCtrl",["$scope","$location","$state",function(a,b,c){a.menu=[{title:"Home",link:"/"},{title:"Login",link:"/login"}],"dashboard"==c.current.name&&(a.menu=[{title:"Dashboard",link:"/dashboard"},{title:"Logout",link:"/logout"}]),a.isCollapsed=!0,a.isActive=function(a){return a===b.path()}}]),angular.module("stripePaymentsApp").run(["$templateCache",function(a){a.put("app/dashboard/dashboard.html",'<div ng-include="\'components/navbar/navbar.html\'"></div><header class=hero-unit id=banner><div class=container><h1>Sample App - Admin Dashboard</h1></div></header><div class=container><div class=row><div class=col-lg-12><h1 class=page-header>Users</h1><div class="panel panel-default"><table class="table table-striped"><thead><tr><th>#</th><th>Name</th><th>Email</th></tr></thead><tbody><tr ng-repeat="(key, user) in users"><td>{{ key+1 }}</td><td>{{ user.name }}</td><td>{{ user.email }}</td></tr></tbody></table></div></div></div><div class=row><div class=col-lg-12><h1 class=page-header>Stripe Transactions</h1><div class="panel panel-default"><table class="table table-striped"><thead><tr><th>#</th><th>Date</th><th>Description</th><th>Amount (in cents)</th><th>Transaction ID</th></tr></thead><tbody><tr ng-repeat="(key, trans) in transactions"><td>{{ key+1 }}</td><td>{{ trans.created | date:\'medium\' }}</td><td>{{ trans.description }}</td><td>{{ trans.amount }}</td><td>{{ trans.refId }}</td></tr></tbody></table></div></div></div></div><footer class=footer><div class=container><p>Stripe-Payment App v1.0 | <a href=mailto:velmurugan@proisc.com>@Author</a></p></div></footer>'),a.put("app/main/login.html",'<div ng-include="\'components/navbar/navbar.html\'"></div><header class=hero-unit id=banner><div class=container><h1>Sample App - Login</h1></div></header><div class=container><div class=row><div class=col-lg-12><h1 class=page-header>Login</h1><div class=row><div class=col-md-4><form novalidate ng-submit=login(user)><div class=form-group><label>Email Address</label><input class=form-control ng-model=user.email required></div><div class=form-group><label>Password</label><input type=password class=form-control ng-model=user.password required></div><button class="btn btn-lg btn-block btn-primary">Login</button></form></div><div class="col-md-8 panel panel-default"><h3>Admin Login details</h3><hr><p>Email : admin@proisc.com<br>Password : admin</p></div></div></div></div></div><footer class=footer><div class=container><p>Stripe-Payment App v1.0 | <a href=mailto:velmurugan@proisc.com>@Author</a></p></div></footer>'),a.put("app/main/main.html","<div ng-include=\"'components/navbar/navbar.html'\"></div><header class=hero-unit id=banner><div class=container><h1>Sample App</h1><p class=lead>A sample account setup form can work through with stripe payment gateway and the payment transactions will be accessed by the admin.</p></div></header><div class=container><div class=row><div class=col-lg-12><h1 class=page-header>Account setup <span class=text-danger style=font-size:14px>1$ will be charged per account</span></h1><form class=row ng-submit=accountSetup(card) novalidate><div class=col-md-4><div class=form-group><label>Name</label><input ng-model=card.name class=form-control required></div><div class=form-group><label>Email</label><input type=email ng-model=card.email class=form-control required></div><div class=form-group><label>Password</label><input type=password ng-model=card.password class=form-control required></div><div class=form-group><label>Card Number</label><input ng-model=card.no class=form-control required></div><div class=form-group><label>Card Validity (MM &amp; YYYY)</label><br><select ng-model=card.month class=form-control style=width:100px;display:inline required><option value=\"\">-MM-</option><option ng-repeat=\"month in ['01','02','03','04','05','06','07','08','09','10','11','12']\" value=\"{{ month }}\">{{ month }}</option></select><select ng-model=card.year class=form-control style=width:100px;display:inline;margin-left:10px required><option value=\"\">-YYYY-</option><option ng-repeat=\"year in years()\" value=\"{{ year }}\">{{ year }}</option></select></div><div class=form-group><label>CVC Number</label><input type=password ng-model=card.cvc class=form-control required></div><button class=\"btn btn-primary btn-block btn-lg\">Setup</button></div><div class=\"col-md-8 panel panel-default\"><h3>Demo Card details</h3><hr><p>Card Number : 4242424242424242<br>MM &amp; YYYY : 08 / 2019<br>CVC : 123</p></div></form></div></div></div><footer class=footer><div class=container><p>Stripe-Payment App v1.0 | <a href=mailto:velmurugan@proisc.com>@Author</a></p></div></footer>"),a.put("components/ajaxLoader/loader.html",'<div class=loader-overlay><div class=loader><img src="assets/images/a1809496.fancy-bounce.gif"></div></div>'),a.put("components/modal/modal.html",'<div class=modal-header><button ng-if=modal.dismissable type=button ng-click=$dismiss() class=close>&times;</button><h4 ng-if=modal.title ng-bind=modal.title class=modal-title></h4></div><div class=modal-body><p ng-if=modal.text ng-bind=modal.text></p><div ng-if=modal.html ng-bind-html=modal.html></div></div><div class=modal-footer><button ng-repeat="button in modal.buttons" ng-class=button.classes ng-click=button.click($event) ng-bind=button.text class=btn></button></div>'),a.put("components/navbar/navbar.html",'<div class="navbar navbar-default navbar-static-top" ng-controller=NavbarCtrl><div class=container><div class=navbar-header><button class=navbar-toggle type=button ng-click="isCollapsed = !isCollapsed"><span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span></button> <a href="/" class=navbar-brand>stripe-payments</a></div><div collapse=isCollapsed class="navbar-collapse collapse" id=navbar-main><ul class="nav navbar-nav"><li ng-repeat="item in menu" ng-class="{active: isActive(item.link)}"><a ng-href={{item.link}}>{{item.title}}</a></li></ul></div></div></div>')}]);